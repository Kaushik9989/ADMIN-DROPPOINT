
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create Partner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet" />

 <style>
    body {
      background: linear-gradient(135deg, #6e8efb, #a777e3);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .card {
      border-radius: 15px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      background: rgba(255, 255, 255, 0.95);
    }

    .btn-primary {
      background: #5a67d8;
      border: none;
      border-radius: 8px;
      padding: 12px;
    }

    .btn-primary:hover {
      background: #4c51bf;
    }

    .form-control:focus {
      border-color: #5a67d8;
      box-shadow: 0 0 8px rgba(90, 103, 216, 0.3);
    }

    #suggestions {
      max-height: 200px;
      overflow-y: auto;
    }
  </style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <%- include("./imports/adminTopbar") %>
  <%- include("./imports/adminSidebar") %>
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-6">

      <div class="card shadow-sm border-0 mt-5">
        <div class="card-body p-4">

          <h3 class="mb-3">üîê Create Partner API Key</h3>

          <% if (error) { %>
            <div class="alert alert-danger"><%= error %></div>
          <% } %>

          <form method="POST" action="/admin/create-partner">
            <div class="mb-3">
              <label class="form-label">Partner Name</label>
              <input
                type="text"
                name="name"
                class="form-control"
                placeholder="Amazon / Flipkart / Swiggy"
                required
              />
            </div>

            <button class="btn btn-primary w-100">
              Generate API Key
            </button>
          </form>

          <% if (apiKey) { %>
            <hr>

            <div class="alert alert-success">
              <strong>Partner Created!</strong>
            </div>

            <div class="mb-2">
              <label class="form-label">Partner Name</label>
              <input class="form-control" value="<%= partnerName %>" readonly>
            </div>

            <div class="mb-2">
              <label class="form-label">API Key</label>
              <input class="form-control" value="<%= apiKey %>" readonly>
            </div>

            <div class="text-muted mt-2">
              ‚ö†Ô∏è Copy and store this key securely. It won‚Äôt be shown again.
            </div>
          <% } %>

        </div>
      </div>
<!-- ================= PARTNER REQUESTS ================= -->
<div class="container pb-5">
  <div class="row justify-content-center">
    <div class="col-md">

      <div class="card shadow-sm border-0 mt-4">
        <div class="card-body p-4">

          <h4 class="mb-3">üì® Partner Access Requests</h4>

          <% if (!requests || requests.length === 0) { %>
            <div class="text-muted">No partner requests yet.</div>
          <% } else { %>

          <div class="table-responsive">
            <table class="table table-hover align-middle">
              <thead class="table-light">
                <tr>
                  <th>Company</th>
                  <th>Contact</th>
                  <th>Email</th>
                  <th>Phone</th>
                  <th>Status</th>
                  <th>Message</th>
                  <th class="text-end">Action</th>
                </tr>
              </thead>
              <tbody>
                <% requests.forEach(r => { %>
                  <tr>
                    <td class="fw-semibold"><%= r.companyName %></td>
                    <td><%= r.contactName %></td>
                    <td><%= r.email %></td>
                    <td><%= r.phone %></td>
                    <td>
                      <% if (r.status === "pending") { %>
                        <span class="badge bg-warning text-dark">Pending</span>
                      <% } else if (r.status === "approved") { %>
                        <span class="badge bg-success">Approved</span>
                      <% } else { %>
                        <span class="badge bg-danger">Rejected</span>
                      <% } %>
                    </td>
                    <td style="max-width:200px;">
                      <%= r.message || "-" %>
                    </td>
                    <td class="text-end">

                      <% if (r.status === "pending") { %>

                        <form method="POST" action="/admin/partner-requests/<%= r._id %>/approve" style="display:inline;">
                          <button class="btn btn-sm btn-success">
                            Approve
                          </button>
                        </form>

                        <form method="POST" action="/admin/partner-requests/<%= r._id %>/reject" style="display:inline;">
                          <button class="btn btn-sm btn-outline-danger">
                            Reject
                          </button>
                        </form>

                      <% } else { %>
                        <span class="text-muted small">No actions</span>
                      <% } %>

                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>

          <% } %>

        </div>
      </div>

    </div>
  </div>
</div>

    </div>
    
  </div>
</div>

</body>
</html>